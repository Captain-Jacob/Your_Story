<Window x:Class="Your_Story.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Your Story" Height="680" Width="1000"
        WindowStartupLocation="CenterScreen">
  <Window.Resources>
    <!-- Basit tema -->
    <Style TargetType="TextBlock">
      <Setter Property="FontFamily" Value="Segoe UI"/>
      <Setter Property="Foreground" Value="#222"/>
    </Style>
    <Style TargetType="TextBox">
      <Setter Property="FontFamily" Value="Segoe UI"/>
      <Setter Property="Margin" Value="0,2,0,6"/>
      <Setter Property="Padding" Value="6"/>
    </Style>
    <Style TargetType="Button">
      <Setter Property="Padding" Value="8,6"/>
      <Setter Property="Margin" Value="0,0,8,0"/>
    </Style>
    <Style TargetType="GroupBox">
      <Setter Property="Margin" Value="0,8,0,0"/>
      <Setter Property="Padding" Value="6"/>
    </Style>
    <!-- Calendar görünümü -->
    <Style TargetType="Calendar">
      <Setter Property="BorderBrush" Value="#DDD"/>
      <Setter Property="BorderThickness" Value="1"/>
      <Setter Property="Background" Value="#FAFAFA"/>
    </Style>
    <Style TargetType="{x:Type CalendarDayButton}">
      <Setter Property="Margin" Value="2"/>
      <Setter Property="BorderBrush" Value="#CCC"/>
      <Setter Property="BorderThickness" Value="1"/>
      <Setter Property="Padding" Value="4"/>
    </Style>
  </Window.Resources>

  <Grid Margin="16">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="*"/>
    </Grid.RowDefinitions>

    <!-- Üst bar -->
    <DockPanel Grid.Row="0" LastChildFill="False" Margin="0,0,0,8">
      <TextBlock x:Name="LblHeader"
                 Text="Bugün ne yaptın?"
                 FontSize="20" FontWeight="Bold" DockPanel.Dock="Left"/>
      <StackPanel Orientation="Horizontal" DockPanel.Dock="Right" VerticalAlignment="Center">
        <TextBlock Text="🌍:" VerticalAlignment="Center" Margin="0,0,6,0"/>
        <ComboBox x:Name="CmbLang" Width="140" SelectionChanged="CmbLang_SelectionChanged">
          <ComboBoxItem Content="Türkçe" Tag="tr"/>
          <ComboBoxItem Content="English" Tag="en"/>
          <ComboBoxItem Content="日本語"   Tag="ja"/>
          <ComboBoxItem Content="Deutsch" Tag="de"/>
        </ComboBox>
      </StackPanel>
    </DockPanel>

    <!-- İçerik -->
    <Grid Grid.Row="1">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="320"/>
        <ColumnDefinition Width="16"/>
        <ColumnDefinition Width="*"/>
      </Grid.ColumnDefinitions>

      <!-- Sol: Takvim -->
      <StackPanel Grid.Column="0">
        <TextBlock x:Name="LblCalendar" Text="Takvim" FontSize="18" FontWeight="Bold" Margin="0,0,0,8"/>
        <Calendar x:Name="Cal"
                  SelectedDatesChanged="Cal_SelectedDateChanged"
                  Loaded="Cal_Loaded"
                  DisplayDateChanged="Cal_DisplayDateChanged"/>
      </StackPanel>

      <!-- Sağ: Form + Liste -->
      <Grid Grid.Column="2">
        <Grid.RowDefinitions>
          <RowDefinition Height="Auto"/>
          <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Form -->
        <StackPanel Grid.Row="0" Margin="0,0,0,8">
          <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
            <TextBlock x:Name="LblDate" VerticalAlignment="Center" Width="120" Text="Tarih:"/>
            <DatePicker x:Name="Dp" SelectedDateChanged="Dp_SelectedDateChanged" Width="180"/>
          </StackPanel>

          <!-- Saat kullanıcıdan alınmıyor; otomatik eklenecek -->
          <StackPanel Orientation="Horizontal" Visibility="Collapsed">
            <TextBlock x:Name="LblTime" VerticalAlignment="Center" Width="120" Text="Gün Notu:"/>
            <TextBox x:Name="TxtTime" Width="180"/>
          </StackPanel>

          <TextBlock x:Name="LblLong" Text="Uzunca Not:"/>
          <TextBox x:Name="TxtLong" AcceptsReturn="True" TextWrapping="Wrap" Height="130"/>

          <TextBlock x:Name="LblFinal" Margin="0,8,0,0" Text="Final Yorum:"/>
          <TextBox x:Name="TxtFinal" AcceptsReturn="True" TextWrapping="Wrap" Height="80"/>

          <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
            <Button x:Name="BtnSave" Content="Kaydet/Save" Width="120" Click="BtnSave_Click"/>
            <TextBlock x:Name="LblStatus" Margin="12,0,0,0" VerticalAlignment="Center"/>
          </StackPanel>
        </StackPanel>

        <!-- Liste -->
        <GroupBox Grid.Row="1" Header="Kayıtlar/Saves">
          <DockPanel>
            <!-- BURADA tek bağlama var: MouseDoubleClick="Lb_MouseDoubleClick" -->
            <ListBox x:Name="Lb" MouseDoubleClick="Lb_MouseDoubleClick">
              <ListBox.ItemTemplate>
                <DataTemplate>
                  <Border CornerRadius="8" Padding="10" Margin="0,6"
                          Background="#FFF" BorderBrush="#DDD" BorderThickness="1">
                    <StackPanel>
                      <TextBlock FontWeight="SemiBold" Text="{Binding TimeNote}"/>
                      <TextBlock TextWrapping="Wrap" Margin="0,2,0,0" Text="{Binding LongNote}"/>
                      <TextBlock TextWrapping="Wrap" Margin="0,4,0,0" Foreground="#666" Text="{Binding FinalComment}"/>
                      <TextBlock Margin="0,6,0,0" FontSize="11" Foreground="#888"
                                 Text="{Binding CreatedAt, StringFormat='Kaydedildi: {0:yyyy-MM-dd HH:mm}'}"/>
                    </StackPanel>
                  </Border>
                </DataTemplate>
              </ListBox.ItemTemplate>
            </ListBox>
          </DockPanel>
        </GroupBox>
      </Grid>
    </Grid>
  </Grid>
</Window>
